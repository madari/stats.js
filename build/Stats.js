// stats.js r5 - http://github.com/mrdoob/stats.js
function Stats(b,c,a){a=a||{};this.palette=a.palette||Stats.Palettes.Grayscale;this.width=a.width||74;this.height=a.height||30;this.mode=a.mode||Stats.Modes.Average;this.name=b;this.count=this.lastUpdate=this.lastRender=this.max=this.accumulated=0;this.min=16777215;this.period=c||0;this.canvas=document.createElement("canvas");this.canvas.width=this.width;this.canvas.height=this.height;this.context=this.canvas.getContext("2d");this.clear();this.title=document.createElement("div");this.title.innerHTML="<strong>"+b+"</strong>";this.container=document.createElement("div");this.container.id=a.id||"stats-"+b;this.container.className=a.className||"stats";this.container.style.width=this.width+3+"px";this.container.style.fontFamily="Helvetica, Arial, sans-serif";this.container.style.textAlign="left";this.container.style.textTransform="uppercase";this.container.style.fontSize="9px";this.container.style.opacity="0.9";this.container.style.color="rgb("+this.palette.fg[0]+","+this.palette.fg[1]+","+this.palette.fg[2]+")";this.container.style.backgroundColor="rgb("+Math.floor(this.palette.bg[0]/2)+","+Math.floor(this.palette.bg[1]/2)+","+Math.floor(this.palette.bg[2]/2)+")";this.container.style.padding="2px 0px 3px 3px";this.container.appendChild(this.title);this.container.appendChild(this.canvas)}Stats.prototype.clear=function(){this.context.fillStyle="rgb("+this.palette.bg[0]+","+this.palette.bg[1]+","+this.palette.bg[2]+")";this.context.fillRect(0,0,this.width,this.height);this.contextData=this.context.getImageData(0,0,this.width,this.height)};Stats.prototype.getElement=function(){return this.container};Stats.prototype.translate=function(b){var a=this.context.getImageData(0,0,this.width,this.height-b);this.clear();this.context.putImageData(a,0,b);this.contextData=this.context.getImageData(0,0,this.width,this.height)};Stats.prototype.render=function(d){var f,a,b=0,e=4,c=this.contextData.data;d=this.height-Math.min(d,this.height);for(f=0;f<this.height;f++){for(a=0;a<this.width-1;a++){c[b++]=c[e++];c[b++]=c[e++];c[b++]=c[e++];++b;++e}if(f<d){c[b++]=this.palette.bg[0];c[b++]=this.palette.bg[1];c[b++]=this.palette.bg[2];++b}else{c[b++]=this.palette.fg[0];c[b++]=this.palette.fg[1];c[b++]=this.palette.fg[2];++b}e+=4}this.context.putImageData(this.contextData,0,0)};Stats.prototype.update=function(b){var c,a=new Date().getTime();b=b||1;if(this.lastUpdate>0){if(this.period>0){switch(this.mode){case Stats.Modes.Average:this.count++;case Stats.Modes.Cumulative:this.accumulated+=b;break;default:this.accumulated=b}if(a>this.lastRender+this.period){b=this.accumulated;this.accumulated=0;if(this.count>0){b/=this.count}this.count=0}else{b=null}}else{b=this.mode==Stats.Modes.Interval?a-this.lastUpdate:b}}else{this.lastRender=a;b=null}if(b!==null){if(b<this.min){this.min=b}if(b>this.max){this.translate(b-this.max);this.max=b}this.render(b/this.max*this.height/1.2);this.lastRender=a;c="<strong>"+Stats.FormatValue(b)+" "+this.name+"</strong> ";c+="(<span>"+Stats.FormatValue(this.min)+"</span>-<span>"+Stats.FormatValue(this.max)+"</span>)";this.title.innerHTML=c}this.lastUpdate=new Date().getTime()};Stats.FormatValue=function(a){return a>=1000?Math.round(a/100)/10+"k":Math.round(a)};Stats.Modes={Average:0,Cumulative:1,Single:2,Interval:3};Stats.Palettes={Grayscale:{fg:[200,200,200],bg:[16,16,16]},Green:{fg:[0,255,0],bg:[16,48,16]},Cyan:{fg:[0,255,255],bg:[16,16,48]},Red:{fg:[255,0,0],bg:[48,16,16]}};Stats.Builtin={FPS:function(){return new Stats("fps",1000,{palette:Stats.Palettes.Cyan,mode:Stats.Modes.Cumulative})},MS:function(){return new Stats("ms",0,{palette:Stats.Palettes.Green,mode:Stats.Modes.Interval})},Mem:function(){var a=new Stats("mem",1000,{palette:Stats.Palettes.Red,mode:Stats.Modes.Single});a._update=a.update;a.update=function(){if(new Date().getTime()>a.lastRender+a.period){a._update(webkitPerformance.memory.usedJSHeapSize*9.54e-7)}};return a}};
